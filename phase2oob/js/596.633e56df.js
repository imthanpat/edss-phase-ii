"use strict";(self["webpackChunkedss_vue_ii"]=self["webpackChunkedss_vue_ii"]||[]).push([[596],{699:function(e,t,a){var l=a(6265),o=a.n(l);const n="http://10.232.176.34:8080",i="http://10.232.176.34";t["Z"]={ChartInfo(){return o().get(`${i}/data/pages/chart_info.php`).then((e=>e.data))},DeviceList(e,t){return o().get(`${i}/data/pages/device_list.php?project_id=${e}&type=${t}`).then((e=>e.data))},DeviceListII(e,t,a,l,n){let s="";return s="A-Box"==t?"10000":"W-Box"==t?"01000":"VA-Box"==t?"00100":"R-Box"==t?"00010":"TH-Box"==t?"00001":"11111",o().get(`${i}/data/pages/device_list_ii.php?project_id=${e}&typeCode=${s}&page=${a}&limit=${l}&sortBy=${n}`).then((e=>e.data))},DeviceListEDSS(e,t){return o().get(`${i}/data/pages/device_list.php?project_id=${e}&type=${t}`).then((e=>e.data))},DeviceListFilter(e,t){return o().get(`${i}/data/pages/device_list.php?project_id=${e}&type=All&typeCode=${types}`).then((e=>e.data))},GetServerScope(e){return o().get(`${n}/api/plugins/telemetry/DEVICE/`+e+"/values/attributes/SERVER_SCOPE",{headers:{"X-Authorization":"Bearer "+localStorage.getItem("token")}}).then((e=>e.data))},GetSharedScope(e){return o().get(`${n}/api/plugins/telemetry/DEVICE/`+e+"/values/attributes/SHARED_SCOPE",{headers:{"X-Authorization":"Bearer "+localStorage.getItem("token")}}).then((e=>e.data))},SetServerScope(e,t){return o().post(`${n}/api/plugins/telemetry/DEVICE/`+e+"/SERVER_SCOPE",t,{headers:{"X-Authorization":"Bearer "+localStorage.getItem("token")}}).then((e=>e.data))},SetSharedScope(e,t){return o().post(`${n}/api/plugins/telemetry/DEVICE/`+e+"/SHARED_SCOPE",t,{headers:{"X-Authorization":"Bearer "+localStorage.getItem("token")}}).then((e=>e.data))},GetStatusOverview(e,t){return o().get(`${i}/data/pages/sensor_overview.php?project_id=${e}&type=${t}`).then((e=>e.data))},FindDevice(e){return o().get(`${i}/data/pages/find_device.php?searchinfo=${e}`).then((e=>e.data))},FixDashboardIssue(e,t){let a=[t];return o().post(`${n}/api/dashboard/${e}/customers`,a,{headers:{"X-Authorization":"Bearer "+localStorage.getItem("token")}}).then((e=>e.data))},FixDashboardUrl(e,t){let a={};return a["dashboard-url"]=`${n}/dashboards/${e}?publicId=${t}`,o().post(`${n}/api/plugins/telemetry/DEVICE/`+e+"/SERVER_SCOPE",a,{headers:{"X-Authorization":"Bearer "+localStorage.getItem("token")}}).then((e=>e.data))},SetDashboard(e){return o().post(`${n}/api/dashboard`,e,{headers:{"X-Authorization":"Bearer "+localStorage.getItem("token")}}).then((e=>e.data))}}},8596:function(e,t,a){a.r(t),a.d(t,{default:function(){return U}});var l=a(3396),o=a(7139),n=a(7771),i=a(6853),s=a(3238),r=a(1888),d=a(1037),u=a(4075),c=a(6824),f=a(8521),p=a(9694),h=a(1138),m=a(7041),v=a(320),y=a(9888),w=a(131);const g=(0,v.a)({name:"VTable",props:{fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],...(0,p.f)(),...(0,h.Q)(),...(0,m.x$)()},setup(e,t){let{slots:a}=t;const{themeClasses:o}=(0,m.ER)(e),{densityClasses:n}=(0,p.t)(e);return(0,y.L)((()=>{var t,i;return(0,l.Wm)(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!a.top,"v-table--has-bottom":!!a.bottom},o.value,n.value]},{default:()=>[null==(t=a.top)?void 0:t.call(a),a.default&&(0,l.Wm)("div",{class:"v-table__wrapper",style:{height:(0,w.kb)(e.height)}},[(0,l.Wm)("table",null,[a.default()])]),null==(i=a.bottom)?void 0:i.call(a)]})})),{}}});var _=a(6269);const b=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{class:"text-left"},"Type"),(0,l._)("th",{class:"text-left"},"Online"),(0,l._)("th",{class:"text-left"},"Offline"),(0,l._)("th",{class:"text-left"},"Dead"),(0,l._)("th",{class:"text-left"},"New"),(0,l._)("th",{class:"text-left"},"Maintanance")])],-1),x=["onClick"],S=(0,l.Uk)(" Device Type Status : "),W=(0,l._)("div",{class:"chart-wrapper mt-10 mb-10"},[(0,l._)("canvas",{id:"statusOverview",class:"chartjs-render-monitor"})],-1),D=(0,l.Uk)("Project Threshold Setting"),C=(0,l._)("p",{class:"text-caption mb-5"}," This Feature Effect All Device In Your Project immediately, Be Careful ",-1),B=(0,l.Uk)(" Offline "),$=(0,l.Uk)(" Dead "),V={align:"right",class:"pa-5"},k=(0,l.Uk)(" submit "),I=(0,l.Uk)(" Reset ");function E(e,t,a,p,h,m){const v=(0,l.up)("v-card-action");return(0,l.wg)(),(0,l.j4)(c.o,{align:"stretch",class:"justify-center align-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(f.D,{cols:"8"},{default:(0,l.w5)((()=>[(0,l.Wm)(s._,null,{default:(0,l.w5)((()=>[(0,l.Wm)(r.Z,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[b,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(h.items,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.type,onClick:t=>m.selRow(e)},[(0,l._)("td",null,[(0,l.Wm)(d.v,{style:{display:"grid",width:"-webkit-fill-available"},size:"small",class:"ml-5 mr-5 text-center",variant:e.variant,color:e.color,label:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.type),1)])),_:2},1032,["variant","color"])]),(0,l._)("td",null,(0,o.zw)(0==e.online?"-":e.online+" Device(s)"),1),(0,l._)("td",null,(0,o.zw)(0==e.offline?"-":e.offline+" Device(s)"),1),(0,l._)("td",null,(0,o.zw)(0==e.dead?"-":e.dead+" Device(s)"),1),(0,l._)("td",null,(0,o.zw)(0==e.new?"-":e.new+" Device(s)"),1),(0,l._)("td",null,(0,o.zw)(0==e.maintanance?"-":e.maintanance+" Device(s)"),1)],8,x)))),128))])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(f.D,{cols:"4"},{default:(0,l.w5)((()=>[(0,l.Wm)(n.w,{class:"mb-5",border:""},{default:(0,l.w5)((()=>[S,(0,l.Wm)(d.v,{size:"large",class:"text-center",variant:"outlined",label:""},{default:(0,l.w5)((()=>[(0,l._)("strong",null,(0,o.zw)(h.deviceTypeSel),1)])),_:1})])),_:1}),W,(0,l.Wm)(s._,{class:"mt-5"},{default:(0,l.w5)((()=>[(0,l.Wm)(r.Z,null,{default:(0,l.w5)((()=>[(0,l.Wm)(n.w,{icon:"mdi-cog",variant:"outlined",class:"mb-5",border:""},{default:(0,l.w5)((()=>[D])),_:1}),C,(0,l.Wm)(c.o,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f.D,{cols:"12",sm:"12"},{default:(0,l.w5)((()=>[(0,l.Wm)(c.o,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f.D,{col:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(d.v,{class:"ma-2",color:"warning"},{default:(0,l.w5)((()=>[B])),_:1})])),_:1}),(0,l.Wm)(f.D,{col:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(_.h,{class:"ma-2",modelValue:h.conf.offline.days,"onUpdate:modelValue":t[0]||(t[0]=e=>h.conf.offline.days=e),label:"Days"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(f.D,{col:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(_.h,{class:"ma-2",modelValue:h.conf.offline.hours,"onUpdate:modelValue":t[1]||(t[1]=e=>h.conf.offline.hours=e),label:"Hours"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(f.D,{col:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(_.h,{class:"ma-2",modelValue:h.conf.offline.minutes,"onUpdate:modelValue":t[2]||(t[2]=e=>h.conf.offline.minutes=e),label:"Minutes"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c.o,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f.D,{col:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(d.v,{class:"ma-2",color:"error"},{default:(0,l.w5)((()=>[$])),_:1})])),_:1}),(0,l.Wm)(f.D,{col:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(_.h,{class:"ma-2",modelValue:h.conf.dead.days,"onUpdate:modelValue":t[3]||(t[3]=e=>h.conf.dead.days=e),label:"Days"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(f.D,{col:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(_.h,{class:"ma-2",modelValue:h.conf.dead.hours,"onUpdate:modelValue":t[4]||(t[4]=e=>h.conf.dead.hours=e),label:"Hours"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(f.D,{col:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(_.h,{class:"ma-2",modelValue:h.conf.dead.minutes,"onUpdate:modelValue":t[5]||(t[5]=e=>h.conf.dead.minutes=e),label:"Minutes"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u.J),(0,l._)("div",V,[(0,l.Wm)(i.T,{onClick:m.setThreshold,color:"success",disabled:h.btnDisable},{default:(0,l.w5)((()=>[k])),_:1},8,["onClick","disabled"]),(0,l.Wm)(i.T,{class:"ml-4",onClick:m.fromRaw},{default:(0,l.w5)((()=>[I])),_:1},8,["onClick"])])])),_:1})])),_:1})])),_:1})])),_:1})}var A=a(360),R=a(699),z=(a(4531),null),O={computed:{projectId(){return this.$store.state.project.projectId}},watch:{conf:{handler(e,t){this.btnDisable=JSON.stringify({...e})===this.tmpConf},deep:!0},projectId(e,t){this.createChart(),this.loadInfo(e)}},methods:{createChart(){let e={labels:["Dead","Offline","Online","Maintanance"],datasets:[{label:"My First Dataset",data:[0,0,0,0],backgroundColor:["rgb(255, 99, 132)","rgb(255, 159, 64)","#009688","gray"],hoverOffset:4}]},t=document.getElementById("statusOverview"),a=new Chart(t);void 0!=a&&a.destroy(),z=new Chart(document.getElementById("statusOverview"),{type:"doughnut",data:e,options:{legend:{display:!1},plugins:{legend:{display:!1}},aspectRatio:1.5}}),document.getElementById("statusOverview").style.display="none"},updateChart(e){let t=[0,0,0,0];t[0]=e.dead,t[1]=e.offline,t[2]=e.online,t[3]=e.maintanance,null!=z&&(z.config.data.datasets[0].data=[0==t[0]?"N/A":t[0],0==t[1]?"N/A":t[1],0==t[2]?"N/A":t[2],0==t[3]?"N/A":t[3]],z.update(),document.getElementById("statusOverview").style.display="")},setThreshold(){let e={};e.offline_period=1440*this.conf.offline.days+60*this.conf.offline.hours+this.conf.offline.minutes,e.lost_period=1440*this.conf.dead.days+60*this.conf.dead.hours+this.conf.dead.minutes,A.Z.SetListScope(this.projectId,e).then((e=>{this.$swal.fire({icon:"success",title:"Success!",text:"Complete"}),this.loadInfo(this.projectId)})).catch((e=>{console.log(e);let t=e.response.data;401==t.status&&(console.log("In"),this.$swal.fire({icon:"error",title:"Error",text:t.message}),this.$router.push("/login"))}))},chgVal(){let e=1440*this.conf.offline.days+60*this.conf.offline.hours+this.conf.offline.minutes,t=1440*this.conf.dead.days+60*this.conf.dead.hours+this.conf.dead.minutes;this.btnDisable=this.conf.offline.raw==e&&this.conf.dead.raw==t},fromRaw(){this.conf.offline.minutes=this.conf.offline.raw%60;let e=Math.floor(this.conf.offline.raw/60);this.conf.offline.days=Math.floor(e/24),this.conf.offline.hours=e%24,this.conf.dead.minutes=this.conf.dead.raw%60;let t=Math.floor(this.conf.dead.raw/60);this.conf.dead.days=Math.floor(t/24),this.conf.dead.hours=e%24,this.tmpConf=JSON.stringify({...this.conf}),this.btnDisable=!0},selRow(e){this.items.forEach((e=>{e.variant="outlined"})),e.variant="elevated",this.deviceTypeSel=e.type,this.updateChart(e)},loadInfo(e){this.items=[{type:"A-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"W-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"VA-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"TH-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"R-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"All",online:0,offline:0,dead:0,new:0,maintanance:0,color:"error",variant:"outlined"}],A.Z.GetListScope(e).then((t=>{let a=new Date,l=t.find((e=>"offline_period"===e.key))?t.find((e=>"offline_period"===e.key)).value:0,o=t.find((e=>"lost_period"===e.key))?t.find((e=>"lost_period"===e.key)).value:0;this.conf.dead.raw=o,this.conf.offline.raw=l,this.fromRaw(),R.Z.DeviceList(e,"All").then((e=>{if(200==e.status){let t=this.items.filter((e=>"All"===e.type))[0];e.data.forEach(((e,n)=>{let i=1,s=new Date(parseInt(e.last_update)),r=a.setMinutes(a.getMinutes()-l),d=a.setMinutes(a.getMinutes()-o);i="true"==e.maintenance?4:s>r?1:d>s?3:2;let u=null;"A-Box"==e.type?u=this.items.filter((e=>"A-Box"===e.type))[0]:"W-Box"==e.type?u=this.items.filter((e=>"W-Box"===e.type))[0]:"VA-Box"==e.type?u=this.items.filter((e=>"VA-Box"===e.type))[0]:"TH-Box"==e.type?u=this.items.filter((e=>"TH-Box"===e.type))[0]:"R-Box"==e.type&&(u=this.items.filter((e=>"R-Box"===e.type))[0]),1==i?(u.online+=1,t.online+=1):2==i?(u.offline+=1,t.offline+=1):3==i?(u.dead+=1,t.dead+=1):4==i&&(u.maintanance+=1,t.maintanance+=1)})),this.selRow(t)}})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e);let t=e.response.data;401==t.status&&(console.log("In"),this.$swal.fire({icon:"error",title:"Error",text:t.message}),this.$router.push("/login"))}))}},data(){return{btnDisable:!0,tmpConf:null,conf:{offline:{raw:0,days:0,hours:0,minutes:0},dead:{raw:0,days:0,hours:0,minutes:0}},deviceTypeSel:"",items:[{type:"A-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"W-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"VA-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"TH-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"R-Box",online:0,offline:0,dead:0,new:0,maintanance:0,color:"default",variant:"outlined"},{type:"All",online:0,offline:0,dead:0,new:0,maintanance:0,color:"error",variant:"outlined"}]}},mounted(){this.createChart(),this.loadInfo(this.projectId)}},T=a(89);const j=(0,T.Z)(O,[["render",E]]);var U=j},7771:function(e,t,a){a.d(t,{w:function(){return D}});var l=a(3396),o=a(1114);const n=(0,o.J)("v-alert-title");var i=a(6853),s=a(836),r=a(3289),d=a(5221),u=a(9694),c=a(4544),f=a(2465),p=a(5180),h=a(489),m=a(4231),v=a(1138),y=a(7041),w=a(5738),g=a(8717),_=a(2370),b=a(4960),x=a(4870),S=a(320);const W=["success","info","warning","error"],D=(0,S.a)({name:"VAlert",props:{border:{type:[Boolean,String],validator:e=>"boolean"===typeof e||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:b.lE,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>W.includes(e)},...(0,u.f)(),...(0,c.x)(),...(0,f.c)(),...(0,p.y)(),...(0,h.F)(),...(0,m.I)(),...(0,v.Q)(),...(0,y.x$)(),...(0,d.bk)({variant:"flat"})},emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const o=(0,g.z)(e,"modelValue"),v=(0,l.Fl)((()=>{var t;if(!1!==e.icon)return e.type?null!=(t=e.icon)?t:`$${e.type}`:e.icon})),b=(0,l.Fl)((()=>{var t;return{color:null!=(t=e.color)?t:e.type,variant:e.variant}})),{themeClasses:S}=(0,y.ER)(e),{colorClasses:W,colorStyles:D,variantClasses:C}=(0,d.c1)(b),{densityClasses:B}=(0,u.t)(e),{dimensionStyles:$}=(0,c.$)(e),{elevationClasses:V}=(0,f.Y)(e),{locationStyles:k}=(0,p.T)(e),{positionClasses:I}=(0,h.K)(e),{roundedClasses:E}=(0,m.b)(e),{textColorClasses:A,textColorStyles:R}=(0,_.rY)((0,x.Vh)(e,"borderColor")),{t:z}=(0,w.bU)(),O=(0,l.Fl)((()=>({"aria-label":z(e.closeLabel),onClick(e){o.value=!1}})));return()=>{var t,u,c;const f=!(!a.prepend&&!v.value),p=!(!a.title&&!e.title),h=!(!e.text&&!a.text),m=!(!a.close&&!e.closable);return o.value&&(0,l.Wm)(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${!0===e.border?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},S.value,W.value,B.value,V.value,I.value,E.value,C.value],style:[D.value,$.value,k.value],role:"alert"},{default:()=>[(0,d.Ux)(!1,"v-alert"),e.border&&(0,l.Wm)("div",{key:"border",class:["v-alert__border",A.value],style:R.value},null),f&&(0,l.Wm)(s.z,{key:"prepend",defaults:{VIcon:{density:e.density,icon:v.value,size:e.prominent?44:28}}},{default:()=>[(0,l.Wm)("div",{class:"v-alert__prepend"},[a.prepend?a.prepend():v.value&&(0,l.Wm)(r.t,null,null)])]}),(0,l.Wm)("div",{class:"v-alert__content"},[p&&(0,l.Wm)(n,{key:"title"},{default:()=>[a.title?a.title():e.title]}),h&&(a.text?a.text():e.text),null==(t=a.default)?void 0:t.call(a)]),a.append&&(0,l.Wm)("div",{key:"append",class:"v-alert__append"},[a.append()]),m&&(0,l.Wm)(s.z,{key:"close",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>[(0,l.Wm)("div",{class:"v-alert__close"},[null!=(u=null==(c=a.close)?void 0:c.call(a,{props:O.value}))?u:(0,l.Wm)(i.T,O.value,null)])]})]})}}})}}]);
//# sourceMappingURL=596.633e56df.js.map